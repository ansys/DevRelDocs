<!-- HTML header for doxygen 1.9.2-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>optiSLang 3D Postprocessing Script API Documentation (Beta): Linear Algebra</title>
<!-- <link href="tabs.css" rel="stylesheet" type="text/css"/> -->
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="ansys_customdoxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr>
  <!--BEGIN PROJECT_LOGO-->
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('example_linearalgebra.xhtml','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Linear Algebra </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Use the tmath module to perform custom linear algebra operations in your SoS analysis. Here, we calculate the mean and variance of field designs provided with the lsdyna metal forming example.</p>
<div class="fragment"><div class="line">-- load example data:</div><div class="line">sdbfile = sos.currentScriptPath() .. &quot;/../lsdyna/metal_forming__eroded_elements/sos_demo.sdb&quot;</div><div class="line">local settings = sos.LoadDataBaseSettings(sdbfile);</div><div class="line">sos.loadDataBase(sos.database(), settings);</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">-- get all active samples of &#39;pstrain&#39;:</div><div class="line">local pstrain_objects = sos.database():data():filterQuantity(&quot;pstrain&quot;):samples():active()</div><div class="line"></div><div class="line">-- now compute mean and variance</div><div class="line"></div><div class="line">-- create data vectors with value zero and with appropriate dimension</div><div class="line">numElements = sos.numElements(sos.database())</div><div class="line">mean = tmath.ZeroMatrix(numElements,1);</div><div class="line">variance = tmath.ZeroMatrix(numElements,1);</div><div class="line"></div><div class="line">-- loop over all active samples:</div><div class="line">--info(pstrain_objects,1)</div><div class="line">N = pstrain_objects:size()</div><div class="line">print(&quot;There are &quot; .. N .. &quot; samples to be analyzed.&quot;)</div><div class="line">for i=0,N-1 do</div><div class="line">    -- convert field data to a vector:</div><div class="line">    -- if there are &#39;missing items&#39; then the field data vector contains the interpolated values</div><div class="line">    local vec = pstrain_objects[i]:getData()</div><div class="line">    mean = mean + vec</div><div class="line">    variance = variance + vec:CW()^2 -- CW() -&gt; component-wise operator &quot;^2&quot;</div><div class="line">end</div><div class="line">mean = mean/N</div><div class="line">variance = variance/(N-1) - mean:CW()^2*N/(N-1) -- subtract Steiner part</div><div class="line"></div><div class="line"></div><div class="line">-- print some results:</div><div class="line">elem_coors = sos.computeElementCoordinates(sos.database()) -- contains the element center coordinates</div><div class="line">elem_id = 4000 -- element ID 4000</div><div class="line">idx = sos.globalIndexFromElement(sos.database(), 0, elem_id) -- get the index of the element in the data vectors</div><div class="line"></div><div class="line">print(&quot;Element #&quot;..elem_id.. &quot; has a mean of &quot; .. mean[idx] .. &quot; and variance of &quot; .. variance[idx] .. &quot; for the plastic strain:&quot;);</div><div class="line">print(&quot;The center coordinate of the element is &quot;, elem_coors:Col(idx):Transpose())</div><div class="line"></div><div class="line">-- insert the results into SoS database:</div><div class="line">mean_obj = sos.createElementDataObject(sos.database(), mean, false); -- no sample</div><div class="line">sos.database():data():insert( sos.DataObjectKey(&quot;my_mean&quot;, &quot;pstrain&quot;), mean_obj)</div><div class="line">var_obj = sos.createElementDataObject(sos.database(), variance, false); -- no sample</div><div class="line">sos.database():data():insert( sos.DataObjectKey(&quot;my_var&quot;, &quot;pstrain&quot;), var_obj)</div><div class="line"></div><div class="line">-- notice: The values will likely differ from the values computed with the SoS-internal algorithms. SoS treats the missing items in a specific way.</div><div class="line"></div><div class="line">print(&quot;Terminate script with success.&quot;)</div><div class="line"></div><div class="line"></div><div class="line"></div><div class="line">-- some advanced indexing:</div><div class="line">ind1 = tmath.Matrix({{0,1,3,6}}):Transpose()</div><div class="line">ind2 = tmath.Matrix({{0,0},{1,0},{2,0},{7,0}})</div><div class="line">c1 = mean[ind1]</div><div class="line">c2 = mean[ind2]</div><div class="line">print(mean)</div><div class="line">print(&quot;c1\n&quot;,c1)</div><div class="line">print(&quot;c2\n&quot;,c2)</div><div class="line"></div><div class="line">MEAN1 = mean*1</div><div class="line">MEAN2 = mean*1</div><div class="line">MEAN1[ind1] = c1*10</div><div class="line">MEAN2[ind2] = c2*10</div><div class="line">print(&quot;ind1:\n&quot;,ind1:Transpose());</div><div class="line">print(&quot;ind2:\n&quot;,ind2:Transpose());</div><div class="line">print(&quot;MEAN\n&quot;,mean:Transpose())</div><div class="line">print(&quot;MEAN1\n&quot;,MEAN1:Transpose())</div><div class="line">print(&quot;MEAN2\n&quot;,MEAN2:Transpose())</div></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.15-->
<!-- start footer part -->
<script>
	$('.contents').append('<footer><p class="legalfooter" align="center"><small><i>Contains proprietary and confidential information of ANSYS, Inc. and its subsidiaries and affiliates.</i></small></p></footer>');
</script>
<!--END !GENERATE_TREEVIEW-->
</body>
</html>
